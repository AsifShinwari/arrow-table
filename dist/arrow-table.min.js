/* arrow-table.js - Copyright 2014 Gary Green. Licensed under the Apache License, Version 2.0 */!function(t,e){function i(t,e){this.init(t,e)}i.prototype={defaults:{namespace:"arrowtable",beforeMove:e.noop,afterMove:e.noop,listenTarget:"input",focusTarget:"input",enabledKeys:["left","right","up","down"]},KEYS:{37:"left",39:"right",38:"up",40:"down"},init:function(t,i){this.options=e.extend({},this.defaults,i),this.$table=e(t),this.bindEvents()},findMoveTarget:function(t,e){var i;switch(t){case"right":i=e.closest("td").next();break;case"left":i=e.closest("td").prev();break;case"down":i=e.closest("tr").next().find("td:eq("+e.closest("td").index()+")");break;case"up":i=e.closest("tr").prev().find("td:eq("+e.closest("td").index()+")")}return i},move:function(t){var i,s=this.KEYS[t.which],n=e(t.target);if(-1!==e.inArray(s,this.options.enabledKeys)){var o=e.proxy(function(){return this.findMoveTarget(s,n)},this),r=this.options.beforeMove(n[0],o,s);if(r!==!1){var i=o();i.length&&(this.focusTarget(i),this.options.afterMove(n[0],i[0],s))}}},focusTarget:function(t){t.find(this.options.focusTarget).focus()},bindEvents:function(){this.$table.on("keyup."+this.namespace,this.options.listenTarget,e.proxy(this.move,this))},unbindEvents:function(){this.$table.off("keyup."+this.namespace,this.options.listenTarget,e.proxy(this.move,this))},destroy:function(){return this.unbindEvents(),this}},e.fn.arrowTable=function(t){return t=t||{},e(this).each(function(){var s=t.namespace||i.prototype.defaults.namespace;isMethodCall="string"==typeof t,$this=e(this);var n=$this.data(s);if(isMethodCall){if(!n)return this;switch(t){case"destroy":n.destroy(),$this.removeData(s)}return this}return void 0===n?(n=new i(this,t),$this.data(s,n)):n.destroy().init(this,t),this})}}(window,jQuery);